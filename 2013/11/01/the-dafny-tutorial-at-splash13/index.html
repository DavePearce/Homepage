<!doctype html><html lang=en><head><meta name=viewport content="width=device-width,initial-scale=1,maximum-scale=1"><meta property="og:title" content="The Dafny Tutorial at SPLASH'13"><meta name=twitter:title content="The Dafny Tutorial at SPLASH'13"><meta property="og:url" content="https://whileydave.com/2013/11/01/the-dafny-tutorial-at-splash13/"><title>David J. Pearce
(The Dafny Tutorial at SPLASH'13)</title><link rel=stylesheet href=https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css><link rel=stylesheet href=https://whileydave.com/css/page.css><link rel=stylesheet href=https://whileydave.com/css/menu.css><link rel=stylesheet href=https://whileydave.com/css/style.css><link rel=stylesheet href=https://whileydave.com/css/syntax.css></head><body><script>"use strict";function clearMenu(){var e,t,n=window.matchMedia("(max-width: 992px)");n.matches&&(e=document.getElementById("menu-content"),t=document.getElementById("menu"),e.style.display="none",t.style.filter="")}function toggleMenu(){var e,t,n=window.matchMedia("(max-width: 992px)");n.matches&&(e=document.getElementById("menu-content"),t=document.getElementById("menu"),e.style.display==="block"?(e.style.display="none",t.style.filter=""):(e.style.display="block",t.style.filter="brightness(0.8)"))}function toggleList(e){e.style.display="none";for(var t,o=e.parentNode,s=o.childNodes,n=0;n<s.length;++n)t=s[n],t.classList&&t.classList.contains("hidden")&&(t.style.display==="block"?t.style.display="none":t.style.display="block")}</script><header class=topbar><div class=topbar-header onclick=clearMenu()><div class=topbar-title>Dr. David J. Pearce</div><div class=topbar-subtitle></div></div><div class=topbar-social onclick=clearMenu()><a href=https://github.com/DavePearce><i class="fa fa-github" aria-hidden=true></i></a>
<a href=https://twitter.com/WhileyDave><i class="fa fa-twitter" aria-hidden=true></i></a>
<a href=https://www.youtube.com/user/redjamjar/><i class="fa fa-youtube-play" aria-hidden=true></i></a>
<a href=https://www.linkedin.com/in/david-pearce-8592647/><i class="fa fa-linkedin-square" aria-hidden=true></i></a></div><div class=topbar-menu><div id=menu onclick=toggleMenu()><div id=menu-icon><img src=https://whileydave.com/images/menu.png alt=Menu></div><div id=menu-content><a href=https://whileydave.com/blog/>Blog</a>
<a href=https://whileydave.com/projects/>Projects</a>
<a href=https://whileydave.com/publications/>Publications</a>
<a href=https://whileydave.com/talks/>Talks</a>
<a href=https://whileydave.com/>Home</a></div></div></div></header><div class=container onclick=clearMenu()><div class=content><h1 class=post-title>The Dafny Tutorial at SPLASH'13</h1><div class=post-date>Friday, November
1st,
2013</div><hr><p><figure class=text-center><img width=50% src=/images/2013/Dafny.JPG></figure>Today I was attending the Dafny tutorial given by <a href=http://research.microsoft.com/en-us/um/people/leino/>Rustan Leino</a> at <a href=http://splashcon.org/2013/>SPLASH'13</a>. I have to say that this was the highlight of the conference for me. In case you haven&rsquo;t come across it before, <a href=http://research.microsoft.com/en-us/projects/dafny>Dafny</a> is a programming language designed for software verification. It has a lot in common with Whiley, although Dafny is certainly more mature. You can try it out in your web-browser on the <a href=http://rise4fun.com/Dafny>rise4fun</a> site.</p><figure class=text-center><img width=50% src=/images/2013/Rustan.JPG></figure><p>During the tutorial, we went through a number of examples, including several focusing on <a href=http://en.wikipedia.org/wiki/Loop_invariant>loop invariants</a>.Â  For example, here&rsquo;s the Dafny code for the absolute function:</p><pre tabindex=0><code class=language-dafny data-lang=dafny>method abs(x:int, y:int) returns (z:int)
ensures x == z || y == z;
ensures x &lt;= z &amp;&amp; y &lt;= z; {      if x &gt; y {
    return x;
  } else {
    return y;
  }
}
</code></pre><p>You can find the code for this <a href=http://rise4fun.com/Dafny/fHWhB>here</a>, where you can run it directly in your browser and play around with it. In fact, the browser version is surprisingly good, and seems to have improved a lot lately. Dafny statically verifies (automatically) that this method does indeed meet its specification.</p><p>Now, here&rsquo;s one for you to try:</p><pre tabindex=0><code class=language-dafny data-lang=dafny>method To100by2s()
{
  var n := 0;
  while n &lt; 100
  invariant ???;
  {
    n := n + 2;
  }
  assert n == 100;
}
</code></pre><p>The question is: <em>what loop invariant can replace <code>???</code> to prove the assertion holds?</em> Try to solve it <a href=http://rise4fun.com/dafny/iW5I>here</a>! And, there are at least two different ways to do it &mldr;</p><p>Finally, here&rsquo;s a way more complicated example which illustrates binary search:</p><pre tabindex=0><code class=language-Dafny data-lang=Dafny>method BinarySearch(arr: array, key: int) returns (r: int)
  requires arr != null;
  requires forall i,j :: 0 &lt;= i &lt; j &lt; arr.Length ==&gt; arr[i] &lt;= arr[j];
  ensures 0 &lt;= r ==&gt; r &lt; arr.Length &amp;&amp; arr[r] == key;
  ensures r &lt; 0 ==&gt; forall i :: 0 &lt;= i &lt; arr.Length ==&gt; arr[i] != key;
{
  var lo, hi := 0, arr.Length;
  while lo &lt; hi
    invariant 0 &lt;= lo &lt;= hi &lt;= arr.Length;
    invariant forall i :: 0 &lt;= i &lt; lo ==&gt; arr[i] != key;
    invariant forall i :: hi &lt;= i &lt; arr.Length ==&gt; arr[i] != key;
    {
      var mid := (lo+hi) / 2;
      if arr[mid] &lt; key {
        lo := mid + 1;
      } else if arr[mid] &gt; key {
        hi := mid;
      } else if arr[mid] == key {
        return mid;
      }
    }
    return -1;
}
</code></pre><p>Again, you can run the code directly from <a href=http://rise4fun.com/Dafny/itla>here</a>. This example is pretty neat! Although, it&rsquo;s worth mentioning that it doesn&rsquo;t suffer from <a href=http://googleresearch.blogspot.com/2006/06/extra-extra-read-all-about-it-nearly.html>the hidden overflow bug which plagued Java</a> because Dafny, like Whiley, uses unbound arithmetic (i.e. it never overflows).</p><hr></div></div><script async src="https://www.googletagmanager.com/gtag/js?id=G-9MRLB1FVZX"></script>
<script>var doNotTrack=!1;if(!doNotTrack){window.dataLayer=window.dataLayer||[];function gtag(){dataLayer.push(arguments)}gtag("js",new Date),gtag("config","G-9MRLB1FVZX",{anonymize_ip:!1})}</script></body></html>